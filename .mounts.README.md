# SMB Mounts Configuration

Configuration file for managing SMB/CIFS mounts across Linux and macOS systems.

## File Location

- Source: `~/.jsh/.mounts`
- Symlinked to: `~/.mounts` (via stow)
- Synced via: Syncthing

## Schema

```json
{
  "credentials": {
    "credential_set_name": {
      "username": "username",
      "password": "password"
    }
  },
  "mounts": {
    "mount_name": {
      "share": "//server/share",
      "mount_point": {
        "darwin": "/Volumes/mount_name",
        "linux": "/mnt/mount_name"
      },
      "credential": "credential_set_name"
    }
  }
}
```

## Mount Point Options

### OS-Specific (Recommended)

For different paths on different operating systems:

```json
"mount_point": {
  "darwin": "/Volumes/media",
  "linux": "/mnt/media"
}
```

### Universal

For the same path on all operating systems:

```json
"mount_point": "/shared/media"
```

## Usage

### Configure/Mount a share

```bash

task mount              # Default mount (media)
task mount media        # Specific mount by name
task mount data         # Another mount
make mount data         # Via Makefile proxy
```

### Add a new mount

Run the configuration script with a new mount name:

```bash
task mount newmount
```

### Shared Credentials

Multiple mounts can reference the same credential set:

```json
{
  "credentials": {
    "home": { "username": "jay", "password": "..." }
  },
  "mounts": {
    "media": { "share": "//nas/media", "credential": "home" },
    "data": { "share": "//nas/data", "credential": "home" }
  }
}
```

## Auto-Mount (macOS)

LaunchAgents are created per-mount to automatically mount shares:

- At login
- Every 5 minutes if disconnected
- Logs: `~/Library/Logs/com.user.smbmount.<mount_name>.{out,err}`

## Files

- `~/.mounts` - Configuration (JSON)
- `~/.jsh/scripts/unix/configure-mounts.sh` - Configuration script
- `~/.jsh/scripts/unix/mount-smb.sh` - Generic auto-mount script
- `~/Library/LaunchAgents/com.user.smbmount.<mount_name>.plist` - LaunchAgent per mount
