# yaml-language-server: $schema=https://taskfile.dev/schema.json

tasks:
  configure:
    cmds:
      - task: configure-ssh
      - task: configure-terminal
      - task: configure-vscode
      - task: configure-firefox

  configure-firefox:
    cmd: "{{.ROOT_DIR}}/scripts/windows/configure-firefox.sh"

  configure-ssh:
    cmd: "{{.ROOT_DIR}}/scripts/windows/configure-ssh.sh"

  configure-terminal:
    cmd: "{{.ROOT_DIR}}/scripts/windows/configure-terminal.sh"

  configure-vscode:
    cmd: "{{.ROOT_DIR}}/scripts/windows/configure-vscode.sh"

  default:
    cmds:
      - task: configure
      - task: install

  install:
    cmds:
      - task: install-apps
      - task: install-nerd-fonts

  install-apps:
    cmd: powershell.exe -NoProfile -ExecutionPolicy Bypass -Command 'Start-Process -FilePath "winget" -ArgumentList "install {{range .apps}}{{.}} {{end}}" -Verb RunAs -Wait'

  install-nerd-fonts:
    cmd: powershell.exe -NoProfile -ExecutionPolicy Bypass -Command 'Start-Process powershell -ArgumentList "refreshenv; choco install {{range .fonts}}nerd-fonts-{{.}} {{end}} -y" -Verb RunAs -Wait'
    status:
      - |
        {{range .fonts}}
        ls /mnt/c/Windows/Fonts | grep -qi "{{.}}"
        {{end}}

vars:
  apps:
    - Chocolatey.Chocolatey
    - Doist.Todoist
    - DuckDuckGo.DesktopBrowser
    - Git.Git
    - Microsoft.PowerToys
    - Microsoft.VisualStudioCode
    - Microsoft.WindowsTerminal
    - Mozilla.Firefox
    - Rufus.Rufus
    - Syncthing.Syncthing
    - Zoom.Zoom
    - mpv.net
  fonts:
    - FiraCode
    - JetBrainsMono
    - Meslo

version: 3
